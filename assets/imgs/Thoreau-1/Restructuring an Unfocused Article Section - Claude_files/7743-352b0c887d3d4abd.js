"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7743],{66605:function(e,t,n){n.d(t,{P9:function(){return h},Vw:function(){return p},aP:function(){return f},cE:function(){return g},fg:function(){return m},us:function(){return v}});var a=n(5362),i=n(27218),r=n(6385),l=n(13262),o=n(10228),s=n(77930),u=n(7653),c=n(19132),d=n(22534);let f=e=>{let{activeOrganization:t}=(0,i.t)(),n=null==t?void 0:t.uuid,r=!!(t&&e.length>0),o=(0,u.useMemo)(()=>e.map(e=>"/api/organizations/".concat(n,"/sync/chat/").concat(e)),[n,e]),s=(0,u.useMemo)(()=>({queryKey:e.map(e=>[l.cF,{orgUuid:n,syncSourceUuid:e}]),enabled:r,refetchInterval:e=>!!(e.state.data&&(0,c.sf)(e.state.data))&&5e3,meta:{noToast:!0}}),[r,n,e]);return(0,a.Nl)(o,s)},p=e=>!!e.some(e=>e.isLoading)||e.some(e=>e.data&&(0,c.sf)(e.data)),m=e=>Math.ceil(f(e).reduce((e,t)=>{var n,a,i;return t.isLoading||!t.data?e:e+(null!==(i=null===(a=t.data)||void 0===a?void 0:null===(n=a.status)||void 0===n?void 0:n.current_size_bytes)&&void 0!==i?i:0)},0)/r.r6),g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:t,activeOrganization:n}=(0,i.t)(),r=null==t?void 0:t.uuid,u=null==n?void 0:n.uuid,f=(0,s.useQueryClient)(),p=(0,c.gb)();return(0,a.uC)(()=>"/api/organizations/".concat(u,"/sync/chat"),"POST",{enabled:!!n,...e,onSuccess:function(){for(var t,n,a,i,s,c=arguments.length,d=Array(c),p=0;p<c;p++)d[p]=arguments[p];let[m]=d;f.setQueryData([l.cF,{orgUuid:u,syncSourceUuid:m.uuid}],m),m.type===o.Fg.GDRIVE&&m.config.uri&&(null===(t=m.status)||void 0===t?void 0:t.extra)&&(null===(n=m.status)||void 0===n?void 0:n.current_size_bytes)&&f.setQueryData([l.HI,{accountUUID:r,orgUUID:u,documentId:m.config.uri}],{uri:"drive:///".concat(m.config.uri),title:null===(i=m.status)||void 0===i?void 0:i.extra,size:null===(s=m.status)||void 0===s?void 0:s.current_size_bytes}),null===(a=e.onSuccess)||void 0===a||a.call(e,...d)},onError:function(){for(var t,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];null===(t=e.onError)||void 0===t||t.call(e,...a);let[r,l]=a;p(r,l),l.sync_source_type===o.Fg.GDRIVE&&(0,d.ZZ)(l.sync_source_config.uri)}})},h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:t}=(0,i.t)(),n=null==t?void 0:t.uuid,r=(0,s.useQueryClient)();return(0,a.uC)(()=>"/api/organizations/".concat(n,"/sync/chat"),"PUT",{enabled:!!t,...e,onSuccess:function(){for(var t,a=arguments.length,i=Array(a),o=0;o<a;o++)i[o]=arguments[o];let[s]=i;r.setQueryData([l.cF,{orgUuid:n,syncSourceUuid:s.uuid}],s),null===(t=e.onSuccess)||void 0===t||t.call(e,...i)}})},v=()=>{let{activeOrganization:e}=(0,i.t)(),t=null==e?void 0:e.uuid;return(0,a.uC)(e=>"/api/organizations/".concat(t,"/sync/chat/").concat(e),"DELETE",{enabled:!!e})}},18187:function(e,t,n){n.d(t,{HN:function(){return s},SE:function(){return u},Tx:function(){return c}});var a=n(5362),i=n(27218),r=n(13262),l=n(77930),o=n(32559);let s=(e,t)=>{let{account:n,activeOrganization:s}=(0,i.t)(),u=t===(null==n?void 0:n.uuid),c=null==s?void 0:s.uuid,d=(0,l.useQueryClient)(),f=(0,o.Gm)();return(0,a.uC)(()=>"/api/organizations/".concat(c,"/projects/").concat(e,"/accounts/").concat(t),"PUT",{onSuccess:()=>{d.invalidateQueries({queryKey:[r.l3,{projectUuid:e}]}),u&&(f(e),d.invalidateQueries({queryKey:[r.VH,{orgUUID:c}]}),d.invalidateQueries({queryKey:[r.tv,{orgUUID:c}]}),d.invalidateQueries({queryKey:[r.Dn,{orgUUID:c}]}))}})},u=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],{activeOrganization:n}=(0,i.t)(),l=null==n?void 0:n.uuid;return(0,a.WE)("/api/organizations/".concat(l,"/projects/").concat(e,"/accounts"),{queryKey:[r.l3,{projectUuid:e}],enabled:!!(t&&n&&e),staleTime:0})},c=e=>{let{activeOrganization:t}=(0,i.t)(),n=null==t?void 0:t.uuid,o=(0,l.useQueryClient)();return(0,a.uC)(t=>"/api/organizations/".concat(n,"/projects/").concat(e,"/accounts/").concat(t.accountUuid),"PUT",{onSuccess:()=>{o.invalidateQueries({queryKey:[r.l3,{projectUuid:e}]})},transformVariables:e=>({role:e.role})})}},26525:function(e,t,n){n.d(t,{Ch:function(){return F},H0:function(){return R},Qe:function(){return z},Qt:function(){return E},Vn:function(){return Q},kR:function(){return L},kS:function(){return T},sE:function(){return Z}});var a=n(41596),i=n(27573),r=n(5161),l=n(71817),o=n(76220),s=n(3053),u=n(5362),c=n(27218),d=n(27895),f=n(9788),p=n(32737),m=n(30947),g=n(6385),h=n(87033),v=n(35807),y=n(42755),b=n(45144),w=n(7653),x=n(45790),_=n(40950),j=n(41496),k=n(1804);function C(){let e=(0,a._)(["\n  relative\n  grid\n  place-content-center\n  aspect-square\n  rounded-xl\n  cursor-pointer\n  transition\n  [fieldset:not(:disabled)_&]:hover:bg-bg-400\n  [fieldset:disabled_&]:opacity-50\n  [fieldset:disabled_&]:pointer-events-none\n  focus-within:ring\n  inline-flex\n  items-center\n  justify-center\n  relative\n  shrink-0\n  ring-offset-2\n  ring-offset-bg-300\n  ring-accent-main-100\n  focus-visible:outline-none\n  focus-visible:ring-1\n  disabled:pointer-events-none\n  disabled:opacity-50\n  disabled:shadow-none\n  disabled:drop-shadow-none\n  bg-[radial-gradient(ellipse,_var(--tw-gradient-stops))]\n  from-bg-500/10\n  from-50%\n  to-bg-500/30\n  border-0.5\n  border-border-400\n  font-medium\n  font-styrene\n  text-text-100/90\n  transition-colors\n  active:bg-bg-500/50\n  hover:text-text-000\n  hover:bg-bg-500/60\n"]);return C=function(){return e},e}let z=20,U=e=>{let t=e.webkitRelativePath;return t&&t.length?t:e.name},M=e=>e.replace(/\0/g,""),F=e=>{e.extracted_content=M(e.extracted_content),e.file_name=M(e.file_name),e.file_type=M(e.file_type)},P=(e,t)=>({file_name:U(e),file_type:e.type,file_size:e.size,extracted_content:t});function T(e){let{syncSourceCount:t,files:n,setFiles:a,numExistingConversationFiles:s,attachments:u,setAttachments:c,numExistingConversationAttachments:f,detectSameAttachment:m,selectedModel:g,blobFileUploadsEnabled:h,customFileUploadHandler:b}=e,{addError:j}=(0,d.e)(),k=(0,l.wN)(null);return function(e){let{syncSourceCount:t,onUploadComplete:n,existingAttachments:a,existingFiles:l,numExistingConversationAttachments:s,numExistingConversationFiles:u,selectedModel:c,blobFileUploadsEnabled:d,customFileUploadHandler:f}=e,m=(0,_.Z)(),{modelConfig:g}=(0,o.V)(c),h=g.image_in,[b,j,k,C]=function(e){let{syncSourceCount:t,onUploadComplete:n,existingAttachments:a,existingFiles:l,numExistingConversationFiles:s,selectedModel:u,blobFileUploadsEnabled:c,customFileUploadHandler:d}=e,{modelConfig:f}=(0,o.V)(u),p=f.image_in,m=R()&&f.pdf_in,{isUploading:g,setIsUploading:h,handleError:v,handleUpload:y}=Q({imagesEnabled:p,blobFileUploadsEnabled:c,onUploadComplete:n,rasterizePdfUploadsEnabled:m,customFileUploadHandler:d}),b=(0,w.useCallback)(e=>{let{newUploads:n=[],numNewPotentialAttachments:o=0,showError:u=!0}=e,{attachmentUploads:d,imageUploads:f,rasterizedDocumentUploads:g,outOfContextFileUploads:h}=(0,r.Jw)(n,{imagesEnabled:p,blobFileUploadsEnabled:c,rasterizePdfUploadsEnabled:m});return o+d.length+f.length+g.length+h.length+a.length+l.length+t>z?(u&&v((0,i.jsx)(x.Z,{defaultMessage:"You can add at most {count, plural, one {# attachment} other {# attachments}} to a message. Please select fewer attachments.",id:"qxV00r12ob",values:{count:z}})),!1):!(f.length+g.length+l.length+s>100)||(u&&v((0,i.jsx)(x.Z,{defaultMessage:"You can add at most {count, plural, one {# file} other {# files}} to a chat. {suggestion}",id:"QyrCxYs5Jy",values:{count:100,suggestion:s<100?(0,i.jsx)(x.Z,{defaultMessage:"Please select fewer files.",id:"a6KVizNPLe"}):(0,i.jsx)(x.Z,{defaultMessage:"Please consider starting a new chat.",id:"oN0R8lZNm6"})}})),!1)},[p,c,a,l,t,s,v,m]);return[g,h,b,(0,w.useCallback)(async e=>{b({newUploads:e})&&await y(e)},[y,b])]}({syncSourceCount:t,onUploadComplete:n,existingFiles:l,existingAttachments:a,numExistingConversationFiles:u,numExistingConversationAttachments:s,selectedModel:c,blobFileUploadsEnabled:d,customFileUploadHandler:f}),U=function(e){let{handleUpload:t}=e,n=(0,w.useRef)({ready:0,total:0}),a=(0,w.useCallback)(()=>{n.current={ready:0,total:0}},[]),i=(0,w.useCallback)(e=>{n.current.ready+=1,n.current.total===n.current.ready&&t(e)},[t]),r=(0,w.useCallback)((e,t)=>{let a=e.length;for(let l=0;l<a;l++){let a=e[l];a.isFile?(n.current.total+=1,a.file(e=>{t.push(e),i(t)})):a.isDirectory&&a.createReader().readEntries(e=>{r(e,t)})}},[i]);return(0,w.useCallback)(e=>{var t;e.preventDefault(),a();let n=null===(t=e.dataTransfer)||void 0===t?void 0:t.items;if(!n)return;let i=[];for(let e=0;e<(null==n?void 0:n.length);e++){let t=n[e].webkitGetAsEntry();t&&i.push(t)}r(i,[])},[r,a])}({handleUpload:C}),M=(0,w.useCallback)(async e=>{await C(Array.from(e))},[C]),F=(0,w.useCallback)(async e=>{let t=e.target.files;t&&await C(Array.from(t)),e.target.value=""},[C]),P=h?(0,i.jsx)(x.Z,{defaultMessage:"Upload docs or images to Claude\\n(Max {maxUploads}, 30mb each)",id:"ialBpH0eLp",values:{maxUploads:z}}):(0,i.jsx)(x.Z,{defaultMessage:"Add content ({maxUploads} max, 30mb each)\\nAccepts pdf, txt, csv, etc.",id:"70asB5brJP",values:{maxUploads:z}}),T=(0,w.useCallback)(e=>{F(e)},[F]),D=(0,w.useMemo)(()=>({type:"file",accept:(0,r.tB)({imagesEnabled:h,outOfContextFilesEnabled:d}).join(","),onChange:T,multiple:!0,"aria-label":m.formatMessage({defaultMessage:"Upload files",id:"2jjdVzJX0c"})}),[d,h,T,m]);return[b,j,k,U,M,C,(0,i.jsx)(p.u,{className:"text-center",tooltipContent:P,children:(0,i.jsxs)(q,{children:[(0,i.jsx)("input",{"data-testid":"file-upload",className:"absolute inset-0 -z-10 overflow-hidden rounded-xl opacity-0",...D}),b?(0,i.jsx)(v.U,{className:"animate-spin",size:18}):(0,i.jsx)(y.p,{size:18,weight:"light"})]})},"upload-tooltip"),D]}({syncSourceCount:t,onUploadComplete:(0,w.useCallback)(async(e,t)=>{m&&e.find(e=>m(e.extracted_content))&&j((0,i.jsx)(x.Z,{defaultMessage:"The same attachment was already added earlier. Claude sees the full conversation when replying, so there’s no need to re-upload.",id:"Uo3qvhGn7z"})),c(t=>[...t,...e]),a(e=>[...e,...t])},[c,m,j,a]),existingAttachments:u,existingFiles:n,numExistingConversationAttachments:f,numExistingConversationFiles:s,selectedModel:null!=g?g:k,blobFileUploadsEnabled:h,customFileUploadHandler:b})}let D=async(e,t,n)=>{let a=new Image;if(a.src=URL.createObjectURL(e),await new Promise(e=>{a.onload=e,setTimeout(e,250)}),!a.width||!a.height||"image/png"!==e.type&&a.width<=t&&a.height<=n)return e;let i=a.width/a.height,r=a.width,l=a.height;a.width>t&&(l=(r=t)/i),l>n&&(r=(l=n)*i);let o=document.createElement("canvas");o.style.display="none",document.body.appendChild(o);let s=o.getContext("2d");if(!s||!s.imageSmoothingQuality)return document.body.removeChild(o),e;s.imageSmoothingQuality="high",o.width=r,o.height=l,s.drawImage(a,0,0,r,l);let u=await new Promise(e=>{o.toBlob(t=>e(t),"image/webp",.85)});return(document.body.removeChild(o),u)?new File([u],e.name,{type:"image/webp"}):e},Z=()=>{let{value:e}=(0,h.FL)("use_canvas_resize");return(0,w.useCallback)(async t=>e?await D(t,2e3,2e3):t,[e])},E=()=>{let e=N(),t=L();return async(n,a,i)=>{try{return await t(n,a,i)}catch(t){e(t,(0,r.Wr)(n)?"image":"file")}}},S=e=>{let t=N(),n=L(),a=(0,u.OJ)();return async(i,r,l)=>{let o={};try{o.file=await n(i,r,l)}catch(n){n instanceof m.Hx&&"document_too_many_pages"===n.errorCode?o.attachment=await A(a,i,r,e):t(n,"document")}return o}},L=()=>{let e=(0,u.OJ)();return async(t,n,a)=>{let i=new FormData;i.append("file",t);let r=a?"/api/organizations/".concat(n,"/projects/").concat(a,"/upload"):"/api/".concat(n,"/upload"),l=await e(r,{method:"POST",body:i}),o=await l.json();if(l.ok)return o;throw(0,m.fT)(l.status,o,"File upload failed",l.headers)}},I=async(e,t,n,a)=>{let r;let l=new FormData;l.append("file",t);try{r=await e("/api/organizations/".concat(n,"/convert_document"),{method:"POST",body:l})}catch(e){return(0,b.Tb)(e),a((0,i.jsx)(x.Z,{defaultMessage:"One or more file uploads have failed. Please try again.",id:"FIwcYDeyIC"}))}if(429===r.status)return a((0,i.jsx)(x.Z,{defaultMessage:"Too many file upload attempts. Please wait and try again later.",id:"h/6cMHSn1V"}));if(413===r.status)return a((0,i.jsx)(x.Z,{defaultMessage:"Uploaded file is too large. Try uploading a smaller part of the document, or copy/pasting an excerpt from the file.",id:"/mCoauj3Ws"}));if(!r.ok)return a((0,i.jsx)(x.Z,{defaultMessage:"Text extraction failed for one of the uploaded files. Please try again.",id:"ngYPeW4aWf"}));let o=await r.json();return o&&0!==Object.keys(o).length&&o.extracted_content?(o.file_name=U(t),o):a((0,i.jsx)(x.Z,{defaultMessage:"Text extraction failed for one of the uploaded files. Please try again.",id:"ngYPeW4aWf"}))},Q=e=>{var t;let{imagesEnabled:n,blobFileUploadsEnabled:a,rasterizePdfUploadsEnabled:l,onUploadComplete:o,onError:f,projectUuid:p,customFileUploadHandler:m}=e,{activeOrganization:h}=(0,c.t)(),v=null!==(t=null==h?void 0:h.uuid)&&void 0!==t?t:"",[y,b]=(0,w.useState)(!1),{addError:_}=(0,d.e)(),k=(0,w.useCallback)(e=>{b(!1),_(e),f&&f()},[_,f,b]),C=Z(),z=E(),U=S(k),M=(0,u.OJ)(),F=(0,s.z$)(),P=(0,w.useCallback)(async(e,t)=>{if(m){b(!0);try{let t=await m(e);t&&t.length>0&&await o([],t)}catch(e){k(e instanceof Error?e.message:"File upload failed")}finally{b(!1)}return}let{attachmentUploads:s,imageUploads:u,rasterizedDocumentUploads:c,unsupportedUploads:d,tooLargeUploads:f,outOfContextFileUploads:h}=(0,r.Jw)(e,{imagesEnabled:n,blobFileUploadsEnabled:a,rasterizePdfUploadsEnabled:l}),y=d.map(e=>(0,r.mD)(e.name));if(y.length>0)return k((0,i.jsx)(x.Z,{defaultMessage:"Files of the following {count, plural, one {format is} other {formats are}} not supported: {formats}",id:"9JcWWPAZoB",values:{count:y.length,formats:(0,i.jsx)(j.yX,{type:"conjunction",value:[...new Set(y)]})}}));if(f.length>0)return F.track({event_key:"file_upload_too_large",large_files:f.map(e=>({file_type:e.type,file_size:e.size}))}),k((0,i.jsx)(x.Z,{defaultMessage:"You may not upload files larger than 30mb.",id:"Gr/GvEZTX1"}));b(!0);let w=[],_=0,P=(e,n)=>{if(void 0===t)return!0;let a=new Blob([n]).size/g.r6;return!((_+=a)>t)||(k((0,i.jsx)(x.Z,{defaultMessage:"Failed to upload file {filename}. Project knowledge exceeds maximum. Remove files to continue.",id:"MbvF6K3PJd",values:{filename:e}})),!1)};for(let e of s){let t=await A(M,e,v,k);if(!(t&&P(e.name,t.extracted_content)))return;await o([t],[])}for(let e of u){let t=await C(e),n=await z(t,v,p);n&&w.push(n)}for(let e of c){let{file:t,attachment:n}=await U(e,v,p);if(t&&w.push(t),n){if(!P(e.name,n.extracted_content))return;await o([n],[])}}for(let e of h){let t=await z(e,v,p);t&&w.push(t)}await o([],w),b(!1)},[a,M,o,n,k,z,U,v,C,F,l,p,m]);return{isUploading:y,setIsUploading:b,handleError:k,handleUpload:P}},q=f.q.label(C()),A=async(e,t,n,a)=>{if(!(0,r.dF)(t))try{let e=await (0,r.CL)(t);return P(t,e)}catch(e){}let i=await I(e,t,n,a);if(i)return F(i),i},N=()=>{let{addError:e}=(0,d.e)();return(0,w.useCallback)((t,n)=>{if(t instanceof m.Hx){if("rate_limit_error"===t.type){e((0,i.jsxs)("p",{children:[(0,i.jsx)(x.Z,{defaultMessage:"You’ve reached your limit for {resourceType} uploads. Please try again later.",id:"M88GeEDB7r",values:{resourceType:n}}),(0,i.jsx)(k.o,{})]}));return}if("document_password_protected"===t.errorCode){e((0,i.jsx)("p",{children:(0,i.jsx)(x.Z,{defaultMessage:"The document you uploaded is password protected. Please remove the password and try again.",id:"DHwwKwuaCR"})}));return}}if(t instanceof m.Hx&&"Image is too large"===t.message){e((0,i.jsx)("p",{children:(0,i.jsx)(x.Z,{defaultMessage:"Image is too large. <link>Learn more</link>",id:"SFbt+MAvby",values:{link:e=>(0,i.jsx)("a",{href:"https://support.anthropic.com/en/articles/9002500-what-kinds-of-images-can-i-upload-to-claude-ai",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-accent-main-100",children:e})}})}));return}e((0,i.jsx)("p",{children:(0,i.jsx)(x.Z,{defaultMessage:"Your {resourceType} upload failed. Please try again.",id:"ymWsV10Pz1",values:{resourceType:n}})}))},[e])},R=()=>{let{value:e}=(0,h.FL)("janus_claude-ai");return e}},5161:function(e,t,n){n.d(t,{CL:function(){return M},Jw:function(){return C},Wr:function(){return _},dF:function(){return z},eh:function(){return F},mD:function(){return w},tB:function(){return v},wI:function(){return c}});var a=n(27218),i=n(1812),r=n(87033),l=n(18916);let o=[".DS_Store"],s=["jpg","jpeg","png","gif","webp"],u=["image/jpeg","image/png","image/gif","image/webp"],c={"image/jpeg":"jpg","image/png":"png","image/gif":"gif","image/webp":"webp"},d=["bmp","ico","tiff","tif","psd","raw","cr2","nef","orf","sr2","mobi","jp2","jpx","jpm","mj2","svg","svgz","ai","eps","ps","indd","heic","mp4","mov","avi","mkv","wmv","flv","webm","mpeg","mpg","m4v","3gp","ogv","ogg","rm","rmvb","asf","amv","mpe","m1v","m2v","svi","3g2","roq","nsv","f4v","f4p","f4a","f4b","qt","hdmov","divx","div","m2ts","mts","vob","mp3","wav","wma","aac","flac","alac","aiff","ogg","opus","m4a","amr","awb","wmv","ra","rm","mid","midi","mka","ttf","otf","woff","woff2","eot","sfnt","ttc","suit","zip"],f=["xls","xlsx","xlsb","xlm","xlsm","xlt","xltm","xltx","ods"],p=["txt","py","ipynb","js","jsx","html","css","java","cs","php","c","cc","cpp","cxx","cts","h","hh","hpp","rs","R","Rmd","swift","go","rb","kt","kts","ts","tsx","m","mm","mts","scala","rs","dart","lua","pl","pm","t","sh","bash","zsh","csv","log","ini","cfg","config","json","proto","yaml","yml","toml","lua","sql","bat","md","coffee","tex","latex","gd","gdshader","tres","tscn"],m=["docx","rtf","epub","odt","odp","pdf"],g=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/rtf","application/epub+zip","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.presentation","application/pdf"],h=["csv"],v=e=>{let{imagesEnabled:t=!1,outOfContextFilesEnabled:n=!1}=e;return[".pdf",".doc",".docx",".rtf",".epub",".odt",".odp",".pptx",...b(),...t?y():[],...n?f.map(e=>".".concat(e)):[]]},y=()=>s.map(e=>".".concat(e)),b=()=>p.map(e=>".".concat(e)),w=e=>e.split(".").pop().toLowerCase(),x=(e,t)=>{let{imagesEnabled:n=!1,blobFileUploadsEnabled:a=!1}=t,i=w(e.name);return!!(!n&&(s.includes(i)||u.includes(e.type)))||(a?d.includes(i):[...d,...f].includes(i))},_=e=>{let t=w(e.name);return s.includes(t)||u.includes(e.type)},j=e=>[...h,...f].includes(w(e.name)),k=e=>!!o.includes(e.name),C=(e,t)=>{let{imagesEnabled:n=!1,blobFileUploadsEnabled:a=!1,rasterizePdfUploadsEnabled:i}=t,r=[],l=[],o=[],s=[],u=[],c=[];return e.filter(e=>!k(e)).forEach(e=>{let t=n&&_(e);x(e,{imagesEnabled:n,blobFileUploadsEnabled:a})?u.push(e):e.size>3e7?c.push(e):a&&j(e)?o.push(e):i&&("pdf"===w(e.name)||"application/pdf"===e.type)?s.push(e):z(e)?r.push(e):t?l.push(e):r.push(e)}),{attachmentUploads:r,imageUploads:l,rasterizedDocumentUploads:s,unsupportedUploads:u,tooLargeUploads:c,outOfContextFileUploads:o}},z=e=>{let t=w(e.name);return m.includes(t)||g.includes(e.type)},U=e=>{let t=new Uint8Array(e);if(t.length>=4){if(239===t[0]&&187===t[1]&&191===t[2])return"utf-8";if(254===t[0]&&255===t[1]||255===t[0]&&254===t[1])return"utf-16";if(0===t[0]&&0===t[1]&&254===t[2]&&255===t[3]||255===t[0]&&254===t[1]&&0===t[2]&&0===t[3])return"utf-32"}let n=!0,a=Math.min(t.length-1,1e3);for(let e=0;e<a;e+=2)if(0===t[e]&&0===t[e+1]||0!==t[e]&&0!==t[e+1]){n=!1;break}if(n)return"utf-16";let i=!0,r=!1;for(let e=0;e<t.length;e++){let n=t[e];if(n>127){if(r=!0,(224&n)==192){if(e+1>=t.length||(192&t[e+1])!=128){i=!1;break}e+=1}else if((240&n)==224){if(e+2>=t.length||(192&t[e+1])!=128||(192&t[e+2])!=128){i=!1;break}e+=2}else if((248&n)==240){if(e+3>=t.length||(192&t[e+1])!=128||(192&t[e+2])!=128||(192&t[e+3])!=128){i=!1;break}e+=3}else{i=!1;break}}}if(i&&r)return"utf-8";let l=(e=>{let t={ascii:0,nonAscii:0,cyrillic:0,latin1:0,control:0,total:Math.min(e.length,4e3)};for(let n=0;n<t.total;n++){let a=e[n];a<32?t.control++:a<127?t.ascii++:a>127&&(t.nonAscii++,(a>=192&&a<=255||a>=168&&a<=183)&&t.cyrillic++,(a>=128&&a<=159||a>=160&&a<=255)&&t.latin1++)}return t})(t),o=l.cyrillic/l.total*100,s=l.latin1/l.total*100,u=l.ascii/l.total*100;if(l.nonAscii>0){if(o>.3)return"windows-1251";if(s>l.control/l.total*100)return"windows-1252"}return u>90&&l.control/l.total<.1?"ascii":"utf-8"},M=async e=>{let t=await e.arrayBuffer(),n=U(t);try{return new TextDecoder(n,{fatal:!0}).decode(t)}catch(e){if("utf-8"!==n)return new TextDecoder("utf-8",{fatal:!0}).decode(t)}throw Error("Failed to decode file as plain text")};function F(){var e;let{value:t}=(0,r.FL)("ooc_attachments"),{account:n}=(0,a.t)(),o=(0,i.T)(),s=null!==(e=null!=o?o:null==n?void 0:n.settings)&&void 0!==e?e:{},{value:u}=(0,l.h)(s);return!!t&&u}},18916:function(e,t,n){n.d(t,{h:function(){return r}});var a=n(87033),i=n(58183);function r(e){let t=(0,i.useLayer)("frontend").get("analysis_tool_experiment_enabled",!1),{value:n}=(0,a.FL)("rely_on_analysis_flag"),{value:r}=(0,a.FL)("analysis_tool_launch_ga");if(n){var l;return{value:null!==(l=null==e?void 0:e.enabled_artifacts_attachments)&&void 0!==l?l:r,source:"flag"}}return{value:(null==e?void 0:e.enabled_artifacts_attachments)||t,source:"experiment"}}},76220:function(e,t,n){n.d(t,{V:function(){return c},u:function(){return p}});var a=n(5362),i=n(27218),r=n(13262),l=n(87033),o=n(98649),s=n(41270);let u={image_in:!1,pdf_in:!1},c=e=>{let{activeOrganization:t}=(0,i.t)(),n=null==t?void 0:t.uuid,{data:o,isLoading:s,isPlaceholderData:c}=(0,a.WE)("/api/organizations/".concat(n,"/model_configs/").concat(e),{queryKey:[r.Qn,n,e],enabled:!!n,staleTime:3e5,meta:{noToast:!0}}),d=!c&&o||u,{value:f}=(0,l.FL)("claude_ai_cinnamon");return"claude-3-5-haiku-20241022"===e&&f&&(d={image_in:!0,pdf_in:!1}),{isLoading:s,modelConfig:d}},d=s.z.array(s.z.object({model:s.z.string(),name:s.z.string(),description:s.z.string().optional(),inactive:s.z.boolean().optional(),overflow:s.z.boolean().optional(),knowledgeCutoff:s.z.string().optional(),slow_kb_warning_threshold:s.z.number().optional(),paprika_modes:s.z.array(o.Xs).optional()})),f=[],p=()=>{let e=(0,l.Zr)("claude_ai_models","models",f,d),t=e.filter(e=>!e.inactive),n=t.filter(e=>!e.overflow),a=t.filter(e=>e.overflow);return{allModelOptions:e,activeModelOptions:t,mainModels:n,overflowModels:a}}},6766:function(e,t,n){n.d(t,{M:function(){return s}});var a=n(87033),i=n(5068),r=n(7653),l=n(71817),o=n(76220);let s=()=>{let e="sticky-model-selector",{value:t}=(0,a.FL)("sticky_model_selector"),{value:n}=(0,a.FL)("model_selector_enabled"),{activeModelOptions:s}=(0,o.u)(),u=(0,l.wN)(null),c=(0,i.useQuery)({queryKey:[e],queryFn:()=>{if(!t||!n)return null;let a=localStorage.getItem(e);return a===u?null:a&&s.find(e=>e.model===a)?a:null},initialData:null}),d=(0,r.useCallback)(t=>{t&&localStorage.setItem(e,t),c.refetch()},[c]);return{stickyModelPreference:c.data,setStickyModelPreference:d}}},9788:function(e,t,n){n.d(t,{q:function(){return l}});var a=n(10607),i=n(7653);function r(e){return function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),l=1;l<n;l++)r[l-1]=arguments[l];let o=t.map(e=>e.replace(/\n/g,"").trim()),s=i.forwardRef((t,n)=>{let{className:l,...s}=t,u=r.map(e=>"function"==typeof e?e(t):e),c=Object.fromEntries(Object.entries(s).filter(e=>{let[t]=e;return!t.startsWith("$")}));return i.createElement(e,{...c,ref:n,className:(0,a.Z)(o,u,"string"==typeof l?l:"")})});return s.displayName="string"==typeof e?e:e.displayName,s}}function l(e){return r(e)}l.a=r("a"),l.aside=r("aside"),l.button=r("button"),l.main=r("main"),l.div=r("div"),l.form=r("form"),l.nav=r("nav"),l.fieldset=r("fieldset"),l.header=r("header"),l.h1=r("h1"),l.h2=r("h2"),l.h3=r("h3"),l.h4=r("h4"),l.h5=r("h5"),l.th=r("th"),l.td=r("td"),l.input=r("input"),l.label=r("label"),l.p=r("p"),l.section=r("section"),l.span=r("span"),l.li=r("li")}}]);