<link rel="stylesheet" href="https://unpkg.com/bluesky-comments@0.9.0/dist/bluesky-comments.css">

<div id="bluesky-comments"></div>

<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18",
    "react-dom/client": "https://esm.sh/react-dom@18/client"
  }
}
</script>

<script type="module">
  import { createElement } from 'react';
  import { createRoot } from 'react-dom/client';
  import { BlueskyComments } from 'https://unpkg.com/bluesky-comments@0.9.0/dist/bluesky-comments.es.js';

  const author = 'angadhn.com';  // Your Bluesky handle
  const container = document.getElementById('bluesky-comments');
  const root = createRoot(container);
  root.render(
    createElement(BlueskyComments, {
      "author": author,
      commentFilters: [
        comment => comment.post.record.text.length < 2
      ],
      onEmpty: (details) => {
        console.error('Failed to load comments:', details);
        
        let message;
        let postUrl;
        
        if (details.message.includes('No matching post found')) {
          // Case 1: No Bluesky post linking to this page
          message = `
            <p>Comments not enabled for this post yet.</p>
            <p>Share this page on 
              <a href="https://bsky.app/profile/${author}" 
                 target="_blank" 
                 rel="noopener noreferrer">Bluesky</a> 
              to enable comments!</p>`;
        } else if (details.postUri) {
          // Case 2: Bluesky post exists but no comments
          postUrl = details.postUri.replace('at://', 'https://bsky.app/');
          message = `
            <p>No comments yet on this post.</p>
            <p>Join the discussion on 
              <a href="${postUrl}" 
                 target="_blank" 
                 rel="noopener noreferrer">Bluesky</a>!</p>`;
        } else {
          // Case 3: Default case when neither condition is met
          message = `
            <p>Unable to load comments.</p>
            <p>Visit 
              <a href="https://bsky.app/profile/${author}" 
                 target="_blank" 
                 rel="noopener noreferrer">Bluesky</a> 
              to join the discussion!</p>`;
        }

        container.innerHTML = `
          <div style="text-align: center; padding: 2em;">
            ${message}
          </div>
        `;
      }
    })
  );
</script> 