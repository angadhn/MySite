---
layout: default
---

<article>
  <div>
    <h1>{{ page.title }}</h1>
    {% if page.completion_score %}
    <div style="margin-bottom: 0.5em; color: var(--color-subtext);">
      <time>Completion: {{ page.completion_score }}%</time>
    </div>
    {% endif %}
    <time datetime="{{ page.last_modified_at | date_to_xmlschema }}">{% if page.type != 'pages' %}
      {{ content | number_of_words }} words • {% if page.created %}Essay first planted on: {{ page.created | date: "%B %-d, %Y" }} • {% endif %}Last updated on {{ page.last_modified_at | date: "%B %-d, %Y" }}
      {% endif %}
    </time>
  </div>

  <div id="notes-entry-container">
    <content>
      {% assign words = content | number_of_words %}
      
      {% if words > 150 %}
        {% assign content_parts = content | split: '</p>' %}
        {% assign word_count = 0 %}
        {% assign displayed_paragraphs = 0 %}
        
        {% for part in content_parts %}
          {% assign paragraph_words = part | append: '</p>' | strip_html | number_of_words %}
          {% assign next_count = word_count | plus: paragraph_words %}
          
          {% if word_count < 150 and next_count >= 150 %}
            {{ part }}</p>
            {% include newsletter.html %}
            {% assign displayed_paragraphs = forloop.index %}
            {% break %}
          {% else %}
            {{ part }}</p>
            {% assign word_count = next_count %}
            {% assign displayed_paragraphs = forloop.index %}
          {% endif %}
        {% endfor %}
        
        {% for part in content_parts offset:displayed_paragraphs %}
          {{ part }}</p>
        {% endfor %}
      {% else %}
        {{ content }}
      {% endif %}
      
      {% unless page.tags contains 'essays' %}
      <hr>
      

      <side style="font-size: 0.9em">
        <h3 style="margin-bottom: 1em">Notes mentioning this note</h3>
        {% if page.backlinks.size > 0 %}
        <div style="display: grid; grid-gap: 1em; grid-template-columns: repeat(1fr);">
        {% for backlink in page.backlinks %}
          <div class="backlink-box">
          <a class="internal-link" href="{{ site.baseurl }}{{ backlink.url }}{%- if site.use_html_extension -%}.html{%- endif -%}">{{ backlink.title }}</a><br>
          <div style="font-size: 0.9em">{{ backlink.excerpt | strip_html | truncatewords: 20 }}</div>
          </div>
        {% endfor %}
        </div>
        {% else %}
        <div style="font-size: 0.9em">
          <p>
            There are no notes linking to this note.
          </p>
        </div>
        {% endif %}
      </side>
      {% endunless %}
    </content>
  </div>
</article>

<hr>

{% unless page.tags contains 'essays' %}
<div style="margin-bottom: 1em;">
  <a class="internal-link" href="{{ site.baseurl }}/tags"> See all notes by topic </a>
</div>

<p>Here are all the notes in this garden, along with their links, visualized as a graph.</p>

{% include notes_graph.html %}
{% endunless %}
